# Carlier et al. (2020) | DeepSVG: A Hierarchical Generative Network for Vector Graphics Animation


```{admonition} Available resources at a glance
* [arXiv URL to the paper](https://arxiv.org/abs/2007.11301)
* [Github repository with code](https://github.com/alexandre01/deepsvg)
* [Project page](https://alexandre01.github.io/deepsvg)
* [Video](https://youtu.be/w9Bu4u-SsKQ)
```

This paper was accepted to the 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.

:::{figure-md} deepsvg_cover
<img src="deepsvg_cover.png" alt="DeepSVG paper" width="500px">

Screenshot of the [DeepSVG paper](https://arxiv.org/abs/2007.11301)
:::


## Data representation

### Mental model and the paper's nomenclature

The figure below attempts to illustrate the DeepSVG mental model and nomenclature.

:::{figure-md} deepsvg_nomenclature
<img src="deepsvg_nomenclature.png" alt="DeepSVG mental model and nomenclature" width="800px">

Own illustration using the definitions and formulae from the [DeepSVG paper](https://arxiv.org/abs/2007.11301)
:::


### Path encoding example


:::{figure-md} deepsvg_encoding
<img src="deepsvg_encoding.png" alt="DeepSVG encoding" width="900px">

Visualisation of how SVG paths are encoded to a tensor in DeepSVG; visualisation by the author re-using figures from the [DeepSVG paper](https://arxiv.org/abs/2007.11301)
:::

The figure above shows two separate paths:

1. Blue(1) $\rightarrow$ Pink(2) $\rightarrow$ Green(3) $\rightarrow$ Yellow(4) $\rightarrow$ Violet(5)
2. Red(1) $\rightarrow$ Brown(2)

Each of these paths get encoded separately. The path encoding consists of a sequence of commands and arguments plus a visibility and a fill flag.


### Data preprocessing




## Model architecture


:::{figure-md} deepsvg_architecture
<img src="deepsvg_architecture.png" alt="DeepSVG model architecture" width="900px">

DeepSVG model architecture; figure taken from the [DeepSVG paper](https://arxiv.org/abs/2007.11301)
:::


## Reproducing results & critical discussion


The DeepSVG paper is incredibly inspiring and the work that was done by Alexandre within the scope of just his Master's thesis is truly amazing. Alexandre was kind enough to have a long video call with the author and then also helped with various follow-up questions.

### Squiggly, sketchy outputs for unknown reason

It was possible to train a DeepSVG model and use it to generate SVG output. However, it was not possible to reproduce high-quality SVGs: When applied to a training dataset of SVG icons, the results generated by DeepSVG were often somewhat squiggly and looked more like sketches than an accurate icon. The figure below shows a selection of some of the better results.


:::{figure-md} deepsvg_results
<img src="deepsvg_results.png" alt="DeepSVG results" width="900px">

Screenshot of the author's attempts to apply DeepSVG to a training dataset of icons
:::


To better understand the source of the problem, the author applied DeepSVG to a specially designed training dataset. The author chose two (later: three) classes:

1. a simple perfect circle using the SVG tag `<circle>`
2. a simple perfect square using the SVG tag `<rect>`
3. (a simple five-pointed perfect star)

For each class, 1,000 identical copies of the SVG file were placed in a folder. The SVGs used `<circle>` and `<rect>` and needed to be converted into paths first. This was done via preprocessing with SVGO.
The pre-processed SVGs looked indistinguishable from the original SVG files.

DeepSVG was trained for ca. 500 epochs, i.e. more than enough for (a desired) overfitting on the examples which were identical anyways.

The results, shown in the figure below for two and three classes, appear to indicate a general problem with DeepSVG.

:::{figure-md} deepsvg_results_with_identical_examples
<img src="deepsvg_results_with_identical_examples.png" alt="DeepSVG results after training with identical examples" width="400px">

Screenshot of the author's attempts to apply DeepSVG to a training dataset of 1,000 identical icons in two (later: three) classes: circle, square, star
:::

The square gets reproduced most accurately -- but never with 90Â° angles. Generated circles and the stars are of surprisingly poor quality.

This is unexpected. The author of this book was unable to identify the specific reason for this issue. However, if solved, maybe the same DeepSVG could produce significantly better results.

```{admonition} Open question
:class: important
What exactly causes DeepSVG to produce squiggly output even if all the input examples of a class are simple shapes and completely identical? How could this be resolved?
```


### Code for fill property was lost

Unfortunately, the code for using the fill property was lost and would need to be re-implemented. Alexandre outlined how to implement this part to the author.